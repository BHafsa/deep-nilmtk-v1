Search.setIndex({"docnames": ["cv", "deep_nilmtk", "deep_nilmtk.config", "deep_nilmtk.data", "deep_nilmtk.data.loader", "deep_nilmtk.data.loader.pytorch", "deep_nilmtk.data.loader.tensorflow", "deep_nilmtk.data.post_process", "deep_nilmtk.data.pre_process", "deep_nilmtk.disaggregator", "deep_nilmtk.models", "deep_nilmtk.models.pytorch", "deep_nilmtk.models.tensorflow", "deep_nilmtk.trainers", "deep_nilmtk.trainers.utils", "deep_nilmtk.utils", "deep_nilmtk.utils.templates", "deep_nilmtk.utils.templates.baseline_templates", "hparams", "index", "modules", "new_model", "templating", "tracking", "tutorials"], "filenames": ["cv.rst", "deep_nilmtk.rst", "deep_nilmtk.config.rst", "deep_nilmtk.data.rst", "deep_nilmtk.data.loader.rst", "deep_nilmtk.data.loader.pytorch.rst", "deep_nilmtk.data.loader.tensorflow.rst", "deep_nilmtk.data.post_process.rst", "deep_nilmtk.data.pre_process.rst", "deep_nilmtk.disaggregator.rst", "deep_nilmtk.models.rst", "deep_nilmtk.models.pytorch.rst", "deep_nilmtk.models.tensorflow.rst", "deep_nilmtk.trainers.rst", "deep_nilmtk.trainers.utils.rst", "deep_nilmtk.utils.rst", "deep_nilmtk.utils.templates.rst", "deep_nilmtk.utils.templates.baseline_templates.rst", "hparams.rst", "index.rst", "modules.rst", "new_model.rst", "templating.rst", "tracking.rst", "tutorials.rst"], "titles": ["Cross-Validation", "&lt;no title&gt;", "deep_nilmtk.config package", "deep_nilmtk.data package", "deep_nilmtk.data.loader package", "deep_nilmtk.data.loader.pytorch package", "deep_nilmtk.data.loader.tensorflow package", "deep_nilmtk.data.post_process package", "deep_nilmtk.data.pre_process package", "deep_nilmtk.disaggregator package", "deep_nilmtk.models package", "deep_nilmtk.models.pytorch package", "deep_nilmtk.models.tensorflow package", "deep_nilmtk.trainers package", "deep_nilmtk.trainers.utils package", "deep_nilmtk.utils package", "deep_nilmtk.utils.templates package", "deep_nilmtk.utils.templates.baseline_templates package", "Hyper-parameters optimisation", "Deep NILMtk!", "deep_nilmtk", "New model", "Templating", "Tracking the experiments", "Tutorials"], "terms": {"index": [5, 23], "modul": [1, 3, 4, 10, 18, 20], "search": 18, "page": [], "config": [1, 9, 20], "submodul": [1, 13, 20], "hparam": [1, 7, 13, 14, 20], "model": [0, 1, 2, 5, 7, 9, 13, 14, 15, 18, 19, 20, 22, 24], "data": [0, 1, 11, 13, 20, 21], "loader": [1, 2, 3, 11, 13, 20, 21], "util": [1, 13, 20, 22], "post_process": [1, 3, 20], "aggreg": [1, 3, 5, 8, 11, 13, 20], "denorm": [1, 3, 20], "postprocess": [1, 3, 20], "pre_process": [1, 3, 20], "featur": [1, 3, 9, 11, 20], "normal": [1, 3, 7, 11, 13, 20], "preprocess": [1, 3, 20], "threshold": [1, 3, 11, 20], "disaggreg": [1, 11, 15, 20, 22], "nilm_experi": [1, 20], "pytorch": [0, 1, 3, 4, 9, 10, 15, 19, 20], "bert4nilm": [1, 10, 20], "layer": [1, 10, 11, 20], "pl_model": [], "seq2point": [0, 1, 5, 10, 13, 20, 21], "seq2seq": [1, 5, 7, 10, 20, 21], "temporal_pool": [1, 10, 20], "unet_nilm": [1, 10, 20], "tensorflow": [1, 3, 4, 10, 20], "trainer": [1, 9, 20], "test": [1, 5, 7, 11, 19, 20, 21, 22], "test_keras_train": [], "test_torch_train": [], "test_train": [], "cross_valid": [1, 13, 20], "hparams_optim": [1, 13, 20], "keras_train": [1, 20], "torch_train": [1, 20], "trainer_implementor": [1, 20], "templat": [1, 15, 20, 21, 24], "experiment_templ": [1, 15, 20], "check_compat": [1, 20], "experiment_start": [1, 20], "logger": [1, 13, 20], "get_exp_paramet": 2, "defin": [2, 9, 11, 15, 22], "default": [2, 5, 8, 11, 15], "valu": [2, 5, 8, 11, 12, 15, 18], "hyper": [2, 5, 9, 11, 14, 19, 24], "paramet": [2, 5, 7, 8, 9, 11, 12, 13, 14, 15, 22, 23, 24], "experi": [2, 9, 13, 15, 18, 22, 24], "return": [2, 5, 7, 8, 9, 11, 12, 13, 14, 15, 18], "A": [2, 7, 11, 12, 21], "dictionnari": [2, 5, 11, 18], "type": [0, 2, 5, 6, 7, 8, 11, 12, 13, 15, 18, 21], "dict": [2, 5, 8, 11, 12, 15], "bert_dataload": [3, 4, 20], "general_dataload": [3, 4, 20], "temp_dataload": [3, 4, 20], "aggregate_mean": 7, "predict": [7, 9, 11, 13, 15, 23], "stride": [0, 7, 11], "1": [0, 5, 7, 8, 11, 13, 18, 22], "overleap": 7, "sequenc": [5, 7, 8, 11, 13], "us": [0, 5, 7, 8, 9, 11, 12, 13, 14, 18, 22, 23], "mean": [0, 7, 8, 11, 23], "numpi": [7, 8], "arrai": [5, 7, 8], "current": [7, 13, 15], "aggregt": 7, "aggregate_median": 7, "tensor": [7, 11, 12], "n_sampl": 7, "window_s": 7, "descript": [2, 7], "aggregate_seq": 7, "after": 7, "ar": [5, 7, 8, 12, 19, 23], "gener": [5, 7, 8, 11, 13, 18, 23], "case": [7, 12, 13, 19, 23], "param": [5, 7, 8, 9, 11, 12, 13, 14, 15, 18, 19], "2d": [7, 8], "np": [5, 7, 8], "1d": 7, "z": [0, 7, 8, 11, 13], "norm": [0, 7, 8, 11, 13], "none": [0, 5, 6, 7, 8, 11, 12, 13, 15], "function": [0, 7, 8, 11, 12, 15, 18], "dictionnati": 7, "power": [5, 7, 8, 11, 13], "consumpt": [5, 7, 8, 11, 13], "log_denorm": 7, "wa": [7, 22], "log": [7, 8, 15], "min_max_denorm": 7, "min_": 7, "max_": 7, "min": [7, 8, 11], "max": [7, 8, 11], "z_denorm": 7, "std": [7, 8, 11], "log_norm": 8, "min_max_norm": 8, "maximum": [8, 11], "z_norm": 8, "work": 8, "also": [0, 5, 8], "multi": [8, 9], "dimension": 8, "class": [0, 2, 5, 6, 9, 11, 12, 13, 14, 15, 16, 18], "attent": 11, "hidden_dim": 11, "attention_typ": 0, "attention_lay": [], "2": [11, 18, 22], "n_head": [], "8": 11, "x_dim": [], "rep": [], "mlp": [], "dropout": 11, "0": [5, 8, 11, 13, 18], "batchnorm": [], "fals": [5, 7, 8, 13], "base": [5, 6, 9, 11, 12, 13, 14, 15, 16], "forward": [11, 21], "k": [], "v": [], "q": 11, "comput": [8, 11, 12, 22], "perform": [0, 8, 11, 18, 23], "everi": 11, "call": [11, 12], "should": [9, 11, 12, 18], "overridden": [11, 12], "all": [9, 11, 12, 18, 23], "subclass": [11, 12], "although": 11, "recip": 11, "pass": 11, "need": 11, "within": 11, "thi": [0, 2, 4, 5, 8, 9, 11, 12, 15], "one": [11, 12], "instanc": 11, "afterward": 11, "instead": 11, "sinc": 11, "former": 11, "take": [11, 21], "care": 11, "run": [11, 12, 15, 22], "regist": 11, "hook": 11, "while": [11, 22], "latter": 11, "silent": 11, "ignor": 11, "them": 11, "train": [5, 9, 11, 12, 13, 14, 15, 19], "bool": [5, 8, 9, 11], "attnlinear": [], "in_channel": [], "out_channel": [], "x": [11, 12], "batchmlp": [], "input_s": [], "output_s": [], "num_lay": [], "3": [11, 22], "7": [], "true": [8, 9, 15, 18, 23], "appli": 19, "final": 15, "axi": [], "3d": [], "reus": [], "alreadi": 5, "input": [0, 5, 8, 11, 12, 13, 21], "shape": 8, "b": [], "n": [], "d_in": [], "an": [9, 11, 12, 18, 19], "iter": [], "contain": [2, 8, 9], "output": [0, 11, 12, 13, 15], "size": [11, 18], "basic": [], "linear": [], "d_out": [], "where": [], "batchnormsequ": [], "kwarg": [12, 13, 15], "batch": 11, "first": [5, 11], "convlay": [], "in_siz": [0, 5, 6, 11, 13, 18], "32": 11, "64": [11, 13], "128": [], "kernel_s": 11, "bia": [], "bn": [], "activ": [], "relu": [], "pool_filt": 11, "16": [], "lstmblock": [], "5": [0, 5, 11, 13], "mdgmm": [], "in_dim": [], "out_dim": [], "kmix": [], "dist_typ": [], "lognorm": [], "silu": [], "mlplayer": [], "npblockrelu2d": [], "block": 11, "neural": 11, "process": [7, 11], "up": 22, "in_ch": [], "int": [5, 8, 11, 15], "out_ch": [], "pad_out": [], "x1": [], "x2": [], "batch_first_attent": [], "multiheadattent": [], "seq": [5, 11], "hidden": 11, "see": [], "http": [11, 12], "org": [11, 12], "doc": [], "stabl": [], "nn": [11, 18], "html": [], "torch": [], "create_attn_linear": [], "create_conv1": [], "pad": [5, 8, 11], "padding_mod": [], "zero": [], "create_deconv1": [], "output_pad": 11, "create_linear": [], "elu_plus_one_plus_epsilon": [], "ep": 11, "1e": [11, 13], "08": [], "max_valu": [], "6": [], "elu": [], "veri": [], "small": [], "addit": 11, "help": [], "prevent": [], "nan": [], "loss": 11, "rnn": 11, "s2p": 11, "implement": [5, 11, 15], "nilm": [2, 5, 9, 11, 15, 19, 22], "porpos": 11, "dl": [9, 11, 13], "acm": 11, "doi": 11, "pdf": 11, "10": 11, "1145": 11, "3360322": 11, "3360844": 11, "rel": 11, "besid": [2, 11], "paramt": [5, 11], "from": [8, 11, 12, 15, 22], "teh": [11, 15], "parent": 11, "dictionnai": 11, "i": [0, 5, 8, 9, 11, 12, 15, 18, 19, 21, 23], "expect": [5, 11], "includ": [2, 4, 5, 11, 19, 22], "follow": [5, 11, 18, 22], "kei": 11, "feature_typ": [0, 11], "The": [0, 5, 8, 9, 11, 15, 18, 19, 21, 22, 23], "number": [0, 11], "applianc": [5, 8, 9, 11, 22], "list": [5, 8, 9, 11, 12, 18, 22], "str": [8, 11, 15], "static": [11, 12, 18], "get_templ": 11, "abstract": [11, 13], "point": [5, 8, 11, 13], "By": 11, "you": 11, "can": [0, 5, 11, 12, 18, 21], "avoid": 11, "target_norm": [0, 11, 13], "normliz": 11, "target": [5, 6, 8, 11, 13, 14], "float": [5, 11], "mininum": 11, "test_dataload": 11, "dure": [5, 9, 11, 15], "pre": [11, 13, 22], "dataload": [5, 11], "period": 11, "step": [11, 15, 18, 22], "form": 11, "mae": 11, "tupl": [11, 12, 22], "suggest_hparam": [11, 12, 18], "trial": [11, 12, 14, 18], "suggest": [11, 12, 15, 18], "optuna": [11, 12, 14, 18], "sa": [0, 11], "pool": [5, 11], "filter": 11, "50": 11, "latent_s": 11, "node": 11, "last": 11, "1024": 11, "windowgru": 11, "window": [0, 11, 18], "gru": 11, "baseline_templ": [15, 16, 20], "ukdale_templ": [15, 16, 20], "packag": [1, 19, 20], "subpackag": [1, 20], "content": 20, "hieee": [], "deep_nilmtk": [1, 22, 23], "tutori": [], "creat": 15, "new": [12, 24], "optim": [9, 13, 18, 19], "cross": [9, 14, 19, 24], "valid": [9, 13, 14, 19, 24], "track": [14, 24], "let": [], "u": [], "have": [18, 22], "fun": [], "here": [11, 12, 18, 21, 23], "configur": 2, "deep": [5, 9, 11], "nilmtk": [5, 15, 23], "execut": [15, 23], "environ": [], "open": 19, "sourc": [11, 19], "design": [19, 22], "specif": 19, "solv": 19, "It": [2, 9, 11, 12, 18, 19, 22, 23], "compat": [2, 9, 19], "both": [4, 5, 8, 9, 19, 22], "tf": [4, 12, 19], "pipelin": [19, 22], "fulli": 19, "sever": [5, 18, 19], "learn": 19, "tool": [2, 19, 21], "aim": 19, "support": 19, "evalu": 19, "those": 19, "e": [12, 19], "g": [12, 19], "sklearn": 0, "model_select": 0, "timeseriessplit": 0, "which": [0, 12], "suitabl": 0, "split": [0, 8, 13], "strategi": 0, "timeseri": 0, "trigger": 0, "whenev": 0, "fold": 0, "specifi": [0, 5, 8, 13, 15, 23], "other": [0, 15, 18], "paramat": 0, "same": [0, 22], "label": [0, 18], "origin": [0, 11], "print": [], "hello": [], "world": [], "differ": [2, 5, 9, 11, 18], "detail": [2, 12], "dnn": 2, "optimis": [14, 24], "saed_model": 0, "nilmexperi": [0, 9, 11, 18, 22, 23], "model_class": [0, 18], "loader_class": 0, "model_nam": [0, 11, 15], "dot": 0, "backend": [0, 13, 15], "framework": [0, 9], "151": [0, 22], "length": [0, 5, 8, 11, 13], "out_siz": [0, 5, 6, 13], "custom_preprocess": 0, "main": [0, 6, 8, 9, 11, 13, 14, 22], "input_norm": [0, 11], "seq_typ": [0, 5, 11, 13], "map": [0, 21], "point_posit": [0, 5, 6, 13], "mid_posit": [0, 13], "learning_r": [0, 13], "10e": 0, "max_nb_epoch": [0, 11], "max_epoch": [0, 16, 22], "kfold": [0, 11, 14], "would": 0, "creation": 21, "straight": 21, "requir": 21, "onli": [5, 8, 12, 21, 23], "definit": [15, 18, 21], "architectur": 21, "well": [18, 21], "consider": 21, "three": 21, "seq2subsequ": 21, "project": 21, "github": [11, 21], "illustr": [21, 22], "how": [5, 8, 21], "provid": [12, 15, 18, 21], "com": 11, "bhafsa": [], "done": [18, 23], "two": [5, 11, 18], "declar": 18, "set": [8, 18, 22], "insid": 18, "through": 18, "exampl": 18, "normlis": 18, "explicitli": 18, "indic": [8, 12, 18], "toolkit": [18, 22], "conduct": 18, "thei": 18, "save": [13, 15, 18, 22, 23], "checkpoint": [13, 15, 18], "correspond": [18, 23], "folder": [15, 18], "splot": 18, "sub": 18, "accord": [5, 9, 13, 18], "id": [15, 18], "nilm_model": 18, "staticmethod": 18, "def": 18, "self": [11, 18], "dictionari": [11, 18], "each": [8, 9, 11, 15, 18], "window_length": 18, "suggest_int": 18, "low": 18, "99": [5, 11, 13, 18], "high": 18, "560": 18, "els": 18, "outsiz": 18, "go": 18, "use_optuna": [13, 18], "concept": 22, "allow": 22, "univers": 22, "enabl": 22, "develop": 22, "testb": 22, "share": 22, "api": [15, 22, 23], "except": 22, "algorithm": 22, "These": [22, 23], "fair": 22, "comparison": 22, "encourag": 22, "cultur": 22, "nd": 22, "collabor": 22, "time": [8, 15, 22], "resourc": 22, "must": 22, "import": 22, "experimenttempl": [16, 22], "__name__": 22, "__main__": 22, "choos": 22, "configru": 22, "data_path": [16, 22], "template_nam": [16, 22], "ukdale_0": 22, "list_appli": [16, 22], "kettl": [11, 22], "consid": [8, 22], "chosen": [9, 22], "list_baselines_backend": [16, 22], "thelist": 22, "dl_framework": 22, "in_sequ": [16, 22], "out_sequ": [16, 22], "new_model": 22, "extend": 22, "extend_experi": [16, 22], "4": 22, "run_templ": [16, 22], "experiment_nam": [15, 16, 22], "results_path": [13, 15, 16, 22], "f": [15, 22], "mlflow": [13, 15, 22, 23], "mlrun": 22, "automat": 23, "nevertheless": 23, "artifact": 23, "link": 23, "user": 23, "explicit": 23, "nilm_exp": 23, "log_artificat": 23, "result": [8, 14, 15, 23], "pickl": 23, "file": [15, 23], "upon": 23, "request": 23, "network": [11, 12], "avail": 15, "lightn": 15, "independ": 9, "type_target": 7, "post": 7, "hparamet": 7, "energi": 7, "remove_neg": 7, "pred": 7, "compute_statu": [5, 8, 11], "min_off": [8, 11], "min_on": [8, 11], "threshold_std": 8, "return_mean": 8, "appliances_label": 8, "threshold_method": 8, "generate_featur": 8, "get_statu": 8, "ser": 8, "num_seri": 8, "series_len": 8, "num_met": 8, "amount": 8, "seri": 8, "meter": 8, "ser_bin": 8, "With": 8, "binari": 8, "ON": 8, "off": [8, 11], "state": [8, 11], "get_status_by_dur": 8, "get_status_mean": 8, "statu": 8, "get": 8, "pad_data": 8, "sequence_length": 8, "pad_at_begin": [5, 8], "context_s": 8, "target_s": 8, "option": [5, 8, 15], "insert": [5, 8], "norm_typ": 8, "submain": [8, 13], "pd": 8, "datafram": [8, 9], "get_threshold_param": 8, "given": 8, "method": [8, 12], "name": [8, 13, 15], "necessari": 8, "ukdale_data": 8, "load_ukdale_met": 8, "get_threshold": 8, "use_std": 8, "estim": [8, 11], "standard": 8, "deviat": 8, "cluster": 8, "when": [8, 12], "If": 8, "middl": 8, "between": [8, 11], "centroid": 8, "second": 8, "dae": 11, "s2": 11, "queri": 11, "mask": [11, 12], "paper": 11, "found": 11, "3427771": 11, "3429390": 11, "code": 11, "yueeeeeeee": 11, "hyperparamet": [5, 11], "cutoff": 11, "durat": 11, "488": 11, "distanc": 11, "consecut": 11, "256": 11, "head": 11, "transform": 11, "n_layer": 11, "python": 11, "480": 11, "6000": 11, "3100": 11, "fridg": 11, "300": 11, "wash": 11, "machin": 11, "2500": 11, "microwav": 11, "3000": 11, "dishwash": 11, "2000": 11, "20": [11, 13], "200": 11, "26": 11, "calcul": 11, "oper": 11, "rtype": 11, "cutoff_energi": 11, "remov": 11, "spike": 11, "tesnor": 11, "updat": 11, "ower": 11, "set_hprama": 11, "setter": 11, "relat": 11, "minimum": 11, "gelu": 11, "layernorm": 11, "06": [11, 13], "multiheadedattent": 11, "h": 11, "d_model": 11, "positionalembed": 11, "max_len": 11, "positionwisefeedforward": 11, "d_ff": 11, "sublayerconnect": 11, "sublay": 11, "transformerblock": 11, "attn_head": 11, "feed_forward_hidden": 11, "decod": 11, "in_featur": 11, "out_featur": 11, "encod": 11, "ptpnet": 11, "lmssdd": 11, "tpnilm": 11, "check": [11, 12, 15], "non": 11, "intrus": 11, "load": [9, 11], "convolut": 11, "multilabel": 11, "classif": 11, "luca": 11, "massidda": 11, "marino": 11, "marrocu": 11, "simon": 11, "manca": 11, "border": 11, "delai": 11, "out": 11, "30": 11, "init_featur": 11, "init_fetaur": 11, "defeault": 11, "temppool": 11, "experiment_label": 11, "regress": 11, "task_typ": 11, "sequence_typ": 11, "temporalpool": 11, "tempor": [5, 11], "mechan": 11, "combin": 11, "scale": 11, "unetnilm": 11, "unet": 11, "ab": 11, "3427859": 11, "n_channel": 11, "channel": 11, "latent": 11, "unetnilmseq2quantil": 11, "impelement": 11, "quantil": [5, 11, 13], "orgin": 11, "25": [5, 11], "75": [5, 11], "9": [5, 11], "unetnilmseq2q": 11, "seq2quantil": [5, 11, 13], "smooth_pinball_loss": 11, "y": 11, "tau": 11, "alpha": 11, "01": 11, "kappa": 11, "1000": 11, "margin": 11, "pinbal": 11, "hatali": 11, "smooth": 11, "blob": 11, "master": 11, "pinball_loss": 11, "py": 11, "kosta": 11, "et": 11, "al": 11, "novel": 11, "penalti": 11, "noncross": 11, "composit": 11, "via": 11, "arxiv": 11, "preprint": 11, "2019": 11, "target_gener": [], "initialis": 13, "posit": [5, 13], "bertdataset": 5, "dataset": [5, 13, 14], "padding_seq": 5, "in_arrai": 5, "generaldataload": [5, 6], "last_posit": 5, "most": 5, "common": 5, "correpond": 5, "For": [5, 9, 12], "point_positon": 5, "": [5, 13], "90": 5, "get_sampl": 5, "sampl": 5, "start": 5, "aggreagt": 5, "tempdataload": 5, "object": [6, 13, 14, 16], "generate_sequ": 6, "singl": [9, 12], "offer": 9, "advanc": 9, "like": 9, "phase": 9, "entri": 9, "ad": 9, "disaggregate_chunk": 9, "test_main_list": 9, "do_preprocess": 9, "chunk": 9, "get_train": 9, "possibl": 9, "extens": 9, "futur": 9, "partial_fit": 9, "sub_main": 9, "load_kwarg": 9, "result_path": 9, "path": [9, 13, 15], "arg": [12, 15], "In": 12, "just": 12, "reappli": 12, "op": 12, "graph": 12, "build": [12, 13], "note": 12, "directli": 12, "meant": 12, "kera": [12, 13], "To": 12, "alwai": 12, "__call__": 12, "reli": 12, "underli": 12, "boolean": 12, "scalar": 12, "whether": 12, "mode": 12, "infer": 12, "either": 12, "more": 12, "guid": 12, "www": 12, "masking_and_pad": 12, "than": 12, "kerastrain": 13, "trainerimplementor": 13, "fit": 13, "chkpt_path": 13, "exp_nam": 13, "logs_path": [13, 15], "version": 13, "batch_siz": 13, "epoch": [13, 15], "0001": 13, "adam": 13, "patience_optim": 13, "train_idx": 13, "validation_idx": 13, "get_dataset": 13, "get_optim": 13, "get_output_signatur": 13, "load_model": 13, "adadelta": 13, "optimizer_v2": 13, "adagrad": 13, "adamax": 13, "ftrl": 13, "nadam": 13, "rmsprop": 13, "sgd": 13, "gradient_desc": 13, "test_dataset": 13, "train_test_split": 13, "val_idx": 13, "torchtrain": 13, "data_split": 13, "appliance_nam": [13, 14], "log_init": 13, "patience_check": 13, "callback": 13, "checkpoint_callback": 13, "early_stop_callback": 13, "imp": 13, "fit_cv": 13, "fit_hparam": 13, "datset": 13, "custom": [13, 15], "init_model": 13, "predict_model": 13, "chkpt": 13, "testtrain": [], "methodnam": [], "runtest": [], "testcas": [], "test_init": [], "crossvalid": 14, "test_siz": 14, "gap": 14, "trainer_imp": 14, "nfold": 14, "hparamsoptimis": 14, "trainer_impl": 14, "opimis": 14, "objective_cv": 14, "save_best_model": 14, "studi": 14, "keep": 14, "give": 14, "best": 14, "suggest_param": 14, "check_model_backend": 15, "proper": 15, "check_model_class": 15, "inherit": 15, "propor": 15, "present_other_framework": 15, "about": 15, "setup": 15, "mlflow_repo": 15, "nilmt": 15, "dictlogg": 15, "tensorboardlogg": 15, "log_metr": 15, "metric": 15, "get_latest_checkpoint": 15, "checkpoint_path": 15, "latest": 15, "log_result": 15, "api_r": 15, "multi_appli": 15, "correspand": 15, "format": 15, "results_dir": 15, "figure_path": 15, "directori": 15, "its": 15, "subdirectori": 15, "logg": 15, "figur": 15, "save_result": 15, "api_results_f1": 15, "persist": 15, "pickel": 15, "start_log": 15, "filenam": 15, "stop_log": 15, "stop": 15, "assertnumpyarraysequ": 15, "arr1": 15, "arr2": 15, "nilm_experiment_dictionnai": 16, "mlflow_path": 16, "set_data_path": 16, "laoder": 4}, "objects": {"deep_nilmtk.config": [[2, 0, 0, "-", "hparams"]], "deep_nilmtk.config.hparams": [[2, 1, 1, "", "get_exp_parameters"]], "deep_nilmtk.data.loader.pytorch": [[5, 0, 0, "-", "bert_dataloader"], [5, 0, 0, "-", "general_dataloader"], [5, 0, 0, "-", "temp_dataloader"]], "deep_nilmtk.data.loader.pytorch.bert_dataloader": [[5, 2, 1, "", "BERTDataset"]], "deep_nilmtk.data.loader.pytorch.bert_dataloader.BERTDataset": [[5, 3, 1, "", "compute_status"], [5, 3, 1, "", "padding_seqs"]], "deep_nilmtk.data.loader.pytorch.general_dataloader": [[5, 2, 1, "", "GeneralDataLoader"]], "deep_nilmtk.data.loader.pytorch.general_dataloader.GeneralDataLoader": [[5, 3, 1, "", "get_sample"]], "deep_nilmtk.data.loader.pytorch.temp_dataloader": [[5, 2, 1, "", "TempDataLoader"]], "deep_nilmtk.data.loader.tensorflow": [[6, 0, 0, "-", "general_dataloader"]], "deep_nilmtk.data.loader.tensorflow.general_dataloader": [[6, 2, 1, "", "GeneralDataLoader"], [6, 1, 1, "", "generate_sequences"]], "deep_nilmtk.data.post_process": [[7, 0, 0, "-", "aggregate"], [7, 0, 0, "-", "denormalize"], [7, 0, 0, "-", "postprocess"]], "deep_nilmtk.data.post_process.aggregate": [[7, 1, 1, "", "aggregate_mean"], [7, 1, 1, "", "aggregate_median"], [7, 1, 1, "", "aggregate_seq"]], "deep_nilmtk.data.post_process.denormalize": [[7, 1, 1, "", "denormalize"], [7, 1, 1, "", "log_denorm"], [7, 1, 1, "", "min_max_denorm"], [7, 1, 1, "", "z_denorm"]], "deep_nilmtk.data.post_process.postprocess": [[7, 1, 1, "", "postprocess"], [7, 1, 1, "", "remove_negatives"]], "deep_nilmtk.data.pre_process": [[8, 0, 0, "-", "features"], [8, 0, 0, "-", "normalize"], [8, 0, 0, "-", "preprocess"], [8, 0, 0, "-", "thresholding"]], "deep_nilmtk.data.pre_process.features": [[8, 1, 1, "", "compute_status"], [8, 1, 1, "", "generate_features"], [8, 1, 1, "", "get_status"], [8, 1, 1, "", "get_status_by_duration"], [8, 1, 1, "", "get_status_means"]], "deep_nilmtk.data.pre_process.normalize": [[8, 1, 1, "", "log_norm"], [8, 1, 1, "", "min_max_norm"], [8, 1, 1, "", "normalize"], [8, 1, 1, "", "z_norm"]], "deep_nilmtk.data.pre_process.preprocess": [[8, 1, 1, "", "pad_data"], [8, 1, 1, "", "preprocess"]], "deep_nilmtk.data.pre_process.thresholding": [[8, 1, 1, "", "get_threshold_params"], [8, 1, 1, "", "get_thresholds"]], "deep_nilmtk.disaggregator": [[9, 0, 0, "-", "nilm_experiment"]], "deep_nilmtk.disaggregator.nilm_experiment": [[9, 2, 1, "", "NILMExperiment"]], "deep_nilmtk.disaggregator.nilm_experiment.NILMExperiment": [[9, 3, 1, "", "disaggregate_chunk"], [9, 3, 1, "", "get_trainer"], [9, 3, 1, "", "partial_fit"], [9, 3, 1, "", "result_path"]], "deep_nilmtk.models.pytorch": [[11, 0, 0, "-", "bert4nilm"], [11, 0, 0, "-", "seq2point"], [11, 0, 0, "-", "seq2seq"], [11, 0, 0, "-", "temporal_pooling"], [11, 0, 0, "-", "unet_nilm"]], "deep_nilmtk.models.pytorch.bert4nilm": [[11, 2, 1, "", "Attention"], [11, 2, 1, "", "BERT4NILM"], [11, 2, 1, "", "GELU"], [11, 2, 1, "", "LayerNorm"], [11, 2, 1, "", "MultiHeadedAttention"], [11, 2, 1, "", "PositionalEmbedding"], [11, 2, 1, "", "PositionwiseFeedForward"], [11, 2, 1, "", "SublayerConnection"], [11, 2, 1, "", "TransformerBlock"]], "deep_nilmtk.models.pytorch.bert4nilm.Attention": [[11, 3, 1, "", "forward"], [11, 4, 1, "", "training"]], "deep_nilmtk.models.pytorch.bert4nilm.BERT4NILM": [[11, 3, 1, "", "compute_status"], [11, 3, 1, "", "cutoff_energy"], [11, 3, 1, "", "forward"], [11, 3, 1, "", "get_template"], [11, 3, 1, "", "predict"], [11, 3, 1, "", "set_hpramas"], [11, 3, 1, "", "step"], [11, 4, 1, "", "training"]], "deep_nilmtk.models.pytorch.bert4nilm.GELU": [[11, 3, 1, "", "forward"], [11, 4, 1, "", "training"]], "deep_nilmtk.models.pytorch.bert4nilm.LayerNorm": [[11, 3, 1, "", "forward"], [11, 4, 1, "", "training"]], "deep_nilmtk.models.pytorch.bert4nilm.MultiHeadedAttention": [[11, 3, 1, "", "forward"], [11, 4, 1, "", "training"]], "deep_nilmtk.models.pytorch.bert4nilm.PositionalEmbedding": [[11, 3, 1, "", "forward"], [11, 4, 1, "", "training"]], "deep_nilmtk.models.pytorch.bert4nilm.PositionwiseFeedForward": [[11, 3, 1, "", "forward"], [11, 4, 1, "", "training"]], "deep_nilmtk.models.pytorch.bert4nilm.SublayerConnection": [[11, 3, 1, "", "forward"], [11, 4, 1, "", "training"]], "deep_nilmtk.models.pytorch.bert4nilm.TransformerBlock": [[11, 3, 1, "", "forward"], [11, 4, 1, "", "training"]], "deep_nilmtk.models.pytorch.seq2point": [[11, 2, 1, "", "RNN"], [11, 2, 1, "", "S2P"], [11, 2, 1, "", "SAED"], [11, 2, 1, "", "Seq2Point"], [11, 2, 1, "", "WindowGRU"]], "deep_nilmtk.models.pytorch.seq2point.RNN": [[11, 3, 1, "", "forward"], [11, 3, 1, "", "get_template"], [11, 4, 1, "", "training"]], "deep_nilmtk.models.pytorch.seq2point.S2P": [[11, 3, 1, "", "get_template"], [11, 3, 1, "", "predict"], [11, 3, 1, "", "step"], [11, 3, 1, "", "suggest_hparams"], [11, 4, 1, "", "training"]], "deep_nilmtk.models.pytorch.seq2point.SAED": [[11, 3, 1, "", "forward"], [11, 3, 1, "", "get_template"], [11, 4, 1, "", "training"]], "deep_nilmtk.models.pytorch.seq2point.Seq2Point": [[11, 3, 1, "", "forward"], [11, 3, 1, "", "get_template"], [11, 4, 1, "", "training"]], "deep_nilmtk.models.pytorch.seq2point.WindowGRU": [[11, 3, 1, "", "forward"], [11, 3, 1, "", "get_template"], [11, 4, 1, "", "training"]], "deep_nilmtk.models.pytorch.seq2seq": [[11, 2, 1, "", "DAE"], [11, 2, 1, "", "S2S"], [11, 2, 1, "", "Seq2Seq"]], "deep_nilmtk.models.pytorch.seq2seq.DAE": [[11, 3, 1, "", "forward"], [11, 3, 1, "", "get_template"], [11, 4, 1, "", "training"]], "deep_nilmtk.models.pytorch.seq2seq.S2S": [[11, 3, 1, "", "get_template"], [11, 3, 1, "", "predict"], [11, 3, 1, "", "step"], [11, 4, 1, "", "training"]], "deep_nilmtk.models.pytorch.seq2seq.Seq2Seq": [[11, 3, 1, "", "forward"], [11, 3, 1, "", "get_template"], [11, 4, 1, "", "training"]], "deep_nilmtk.models.pytorch.temporal_pooling": [[11, 2, 1, "", "Decoder"], [11, 2, 1, "", "Encoder"], [11, 2, 1, "", "PTPNet"], [11, 2, 1, "", "TemporalPooling"]], "deep_nilmtk.models.pytorch.temporal_pooling.Decoder": [[11, 3, 1, "", "forward"], [11, 4, 1, "", "training"]], "deep_nilmtk.models.pytorch.temporal_pooling.Encoder": [[11, 3, 1, "", "forward"], [11, 4, 1, "", "training"]], "deep_nilmtk.models.pytorch.temporal_pooling.PTPNet": [[11, 3, 1, "", "forward"], [11, 3, 1, "", "predict"], [11, 3, 1, "", "step"], [11, 3, 1, "", "suggest_hparams"], [11, 4, 1, "", "training"]], "deep_nilmtk.models.pytorch.temporal_pooling.TemporalPooling": [[11, 3, 1, "", "forward"], [11, 4, 1, "", "training"]], "deep_nilmtk.models.pytorch.unet_nilm": [[11, 2, 1, "", "UNETNILM"], [11, 2, 1, "", "UNETNILMSeq2Quantile"]], "deep_nilmtk.models.pytorch.unet_nilm.UNETNILM": [[11, 3, 1, "", "forward"], [11, 3, 1, "", "predict"], [11, 3, 1, "", "step"], [11, 4, 1, "", "training"]], "deep_nilmtk.models.pytorch.unet_nilm.UNETNILMSeq2Quantile": [[11, 3, 1, "", "forward"], [11, 3, 1, "", "predict"], [11, 3, 1, "", "smooth_pinball_loss"], [11, 3, 1, "", "step"], [11, 4, 1, "", "training"]], "deep_nilmtk.models.tensorflow": [[12, 0, 0, "-", "layers"], [12, 0, 0, "-", "seq2point"]], "deep_nilmtk.models.tensorflow.seq2point": [[12, 2, 1, "", "Seq2Point"]], "deep_nilmtk.models.tensorflow.seq2point.Seq2Point": [[12, 3, 1, "", "call"], [12, 3, 1, "", "suggest_hparams"]], "deep_nilmtk.trainers": [[13, 0, 0, "-", "keras_trainer"], [13, 0, 0, "-", "torch_trainer"], [13, 0, 0, "-", "trainer"], [13, 0, 0, "-", "trainer_implementor"]], "deep_nilmtk.trainers.keras_trainer": [[13, 2, 1, "", "KerasTrainer"]], "deep_nilmtk.trainers.keras_trainer.KerasTrainer": [[13, 3, 1, "", "fit"], [13, 3, 1, "", "get_dataset"], [13, 3, 1, "", "get_optimizer"], [13, 3, 1, "", "get_output_signature"], [13, 3, 1, "", "load_model"], [13, 4, 1, "", "optimizers"], [13, 3, 1, "", "predict"], [13, 3, 1, "", "train_test_split"]], "deep_nilmtk.trainers.torch_trainer": [[13, 2, 1, "", "TorchTrainer"]], "deep_nilmtk.trainers.torch_trainer.TorchTrainer": [[13, 3, 1, "", "data_split"], [13, 3, 1, "", "fit"], [13, 3, 1, "", "get_dataset"], [13, 3, 1, "", "load_model"], [13, 3, 1, "", "log_init"], [13, 3, 1, "", "predict"], [13, 3, 1, "", "train_test_split"]], "deep_nilmtk.trainers.trainer": [[13, 2, 1, "", "Trainer"]], "deep_nilmtk.trainers.trainer.Trainer": [[13, 3, 1, "", "fit"], [13, 3, 1, "", "fit_cv"], [13, 3, 1, "", "fit_hparams"], [13, 3, 1, "", "get_dataset"], [13, 3, 1, "", "init_models"], [13, 3, 1, "", "predict"], [13, 3, 1, "", "predict_model"]], "deep_nilmtk.trainers.trainer_implementor": [[13, 2, 1, "", "TrainerImplementor"]], "deep_nilmtk.trainers.trainer_implementor.TrainerImplementor": [[13, 3, 1, "", "fit"], [13, 3, 1, "", "get_dataset"], [13, 3, 1, "", "load_model"], [13, 3, 1, "", "predict"], [13, 3, 1, "", "train_test_split"]], "deep_nilmtk.trainers.utils": [[14, 0, 0, "-", "cross_validator"], [14, 0, 0, "-", "hparams_optimizer"]], "deep_nilmtk.trainers.utils.cross_validator": [[14, 2, 1, "", "CrossValidator"]], "deep_nilmtk.trainers.utils.cross_validator.CrossValidator": [[14, 3, 1, "", "cross_validate"]], "deep_nilmtk.trainers.utils.hparams_optimizer": [[14, 2, 1, "", "HparamsOptimiser"]], "deep_nilmtk.trainers.utils.hparams_optimizer.HparamsOptimiser": [[14, 3, 1, "", "objective"], [14, 3, 1, "", "objective_cv"], [14, 3, 1, "", "optimise"], [14, 3, 1, "", "save_best_model"], [14, 3, 1, "", "suggest_params"]], "deep_nilmtk.utils": [[15, 0, 0, "-", "check_compatibility"], [15, 0, 0, "-", "experiment_starter"], [15, 0, 0, "-", "logger"], [15, 0, 0, "-", "test"]], "deep_nilmtk.utils.check_compatibility": [[15, 1, 1, "", "check_model_backend"], [15, 1, 1, "", "check_model_class"], [15, 1, 1, "", "present_other_framework"]], "deep_nilmtk.utils.experiment_starter": [[15, 1, 1, "", "setup"]], "deep_nilmtk.utils.logger": [[15, 2, 1, "", "DictLogger"], [15, 1, 1, "", "get_latest_checkpoint"], [15, 1, 1, "", "log_results"], [15, 1, 1, "", "results_dir"], [15, 1, 1, "", "save_results"], [15, 1, 1, "", "start_logging"], [15, 1, 1, "", "stop_logging"]], "deep_nilmtk.utils.logger.DictLogger": [[15, 3, 1, "", "log_metrics"]], "deep_nilmtk.utils.templates.baseline_templates": [[17, 0, 0, "-", "ukdale_template"]], "deep_nilmtk.utils.templates": [[16, 0, 0, "-", "experiment_template"]], "deep_nilmtk.utils.templates.experiment_template": [[16, 2, 1, "", "ExperimentTemplate"]], "deep_nilmtk.utils.templates.experiment_template.ExperimentTemplate": [[16, 3, 1, "", "extend_experiment"], [16, 3, 1, "", "run_template"], [16, 3, 1, "", "set_data_path"]], "deep_nilmtk.utils.test": [[15, 1, 1, "", "assertNumpyArraysEqual"]]}, "objtypes": {"0": "py:module", "1": "py:function", "2": "py:class", "3": "py:method", "4": "py:attribute"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"], "2": ["py", "class", "Python class"], "3": ["py", "method", "Python method"], "4": ["py", "attribute", "Python attribute"]}, "titleterms": {"welcom": [], "deep": 19, "nilmtk": 19, "": [], "document": [], "indic": [], "tabl": [], "deep_nilmtk": [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 20], "packag": [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], "subpackag": [10, 15, 16], "modul": [2, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17], "content": [], "config": 2, "submodul": [14, 15, 16, 17], "hparam": 2, "model": [10, 11, 12, 21], "data": [3, 4, 5, 6, 7, 8], "loader": [4, 5, 6], "util": [14, 15, 16, 17], "pytorch": [5, 11], "bert_dataload": 5, "general_dataload": [5, 6], "temp_dataload": 5, "tensorflow": [6, 12], "post_process": 7, "aggreg": 7, "denorm": 7, "postprocess": 7, "pre_process": 8, "featur": 8, "normal": 8, "preprocess": 8, "threshold": 8, "disaggreg": 9, "nilm_experi": 9, "bert4nilm": 11, "layer": 12, "pl_model": [], "seq2point": [11, 12], "seq2seq": 11, "temporal_pool": 11, "unet_nilm": 11, "trainer": [13, 14], "keras_train": 13, "torch_train": 13, "trainer_implementor": 13, "test": 15, "test_keras_train": [], "test_torch_train": [], "test_train": [], "cross_valid": 14, "hparams_optim": 14, "check_compat": 15, "experiment_start": 15, "logger": 15, "templat": [16, 17, 22], "experiment_templ": 16, "baseline_templ": 17, "ukdale_templ": 17, "tutori": 24, "experi": 23, "creat": [], "new": 21, "hyper": 18, "paramet": 18, "optim": [], "cross": 0, "valid": 0, "track": 23, "optimis": 18}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 56}})